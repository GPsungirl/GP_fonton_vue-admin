(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a12a682"],{6726:function(e,r,t){},"755f":function(e,r,t){"use strict";var o=t("6726"),i=t.n(o);i.a},eb88:function(e,r,t){"use strict";t.r(r);var o=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"main-wrapper"},[t("div",{staticClass:"upload_wrap"},[t("div",{staticClass:"upload_item"},[t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.toggleUploadImg(1)}}},[e._v("上传商品LOGO")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.toggleUploadImg(2)}}},[e._v("上传商品banner图")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.toggleUploadImg(3)}}},[e._v("上传商品详情图")]),e._v(" "),t("p",[e._v(e._s(e.imgTypeTxt))]),e._v(" "),t("el-upload",{attrs:{action:"","auto-upload":!0,accept:"jpg,jpeg,png,PNG","list-type":"picture-card","file-list":e.files,"before-upload":e.beforeUpload,"http-request":e.handlePost,"on-preview":e.handlePreview,"on-change":e.changeImage,"on-remove":e.handleRemove,"on-exceed":e.extendLength}},[t("i",{staticClass:"el-icon-plus"}),e._v(" "),t("div",{attrs:{slot:"tip"},slot:"tip"},[e._v("最多可上传5张jpg/png图片，并且每张图片大小不超过500kb")])]),e._v(" "),e.listImgs.length?t("ul",e._l(e.listImgs,(function(r,o){return t("li",{key:o,staticClass:"img_item"},[t("p",[e._v(e._s(r.imgTitle))]),e._v(" "),t("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:r.previewUrl,alt:""}})])})),0):e._e()],1)]),e._v(" "),t("div",{staticStyle:{padding:"30px 50px"}},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,inline:!0,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"商品名称",prop:"goods_name"}},[t("el-input",{attrs:{placeholder:"请选择商品名称"},model:{value:e.ruleForm.goods_name,callback:function(r){e.$set(e.ruleForm,"goods_name",r)},expression:"ruleForm.goods_name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商品类别",prop:"typeid"}},[t("el-select",{attrs:{placeholder:"请选择商品类别"},model:{value:e.ruleForm.typeid,callback:function(r){e.$set(e.ruleForm,"typeid",r)},expression:"ruleForm.typeid"}},e._l(e.goodsTypes,(function(e){return t("el-option",{key:e.typeid,attrs:{label:e.type_name,value:e.typeid}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"商品现价",prop:"price"}},[t("el-input",{attrs:{placeholder:"请输入商品价格"},model:{value:e.ruleForm.price,callback:function(r){e.$set(e.ruleForm,"price",r)},expression:"ruleForm.price"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商品原价",prop:"src_price"}},[t("el-input",{attrs:{placeholder:"请输入商品原价"},model:{value:e.ruleForm.src_price,callback:function(r){e.$set(e.ruleForm,"src_price",r)},expression:"ruleForm.src_price"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商品库存",prop:"stock"}},[t("el-input",{attrs:{placeholder:"请输入商品库存"},model:{value:e.ruleForm.stock,callback:function(r){e.$set(e.ruleForm,"stock",r)},expression:"ruleForm.stock"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商品产地",prop:"made_place"}},[t("el-input",{attrs:{placeholder:"请输入商品产地"},model:{value:e.ruleForm.made_place,callback:function(r){e.$set(e.ruleForm,"made_place",r)},expression:"ruleForm.made_place"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商品供应商",prop:"supplier"}},[t("el-input",{attrs:{placeholder:"请输入商品产地"},model:{value:e.ruleForm.supplier,callback:function(r){e.$set(e.ruleForm,"supplier",r)},expression:"ruleForm.supplier"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商品权重",prop:"goods_order"}},[t("el-input",{attrs:{placeholder:"请输入商品权重"},model:{value:e.ruleForm.goods_order,callback:function(r){e.$set(e.ruleForm,"goods_order",e._n(r))},expression:"ruleForm.goods_order"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商品规格",prop:"unit"}},[t("el-input",{attrs:{placeholder:"请输入商品规格"},model:{value:e.ruleForm.unit,callback:function(r){e.$set(e.ruleForm,"unit",r)},expression:"ruleForm.unit"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商品描述",prop:"goods_desc"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.goods_desc,callback:function(r){e.$set(e.ruleForm,"goods_desc",r)},expression:"ruleForm.goods_desc"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),e._v(" "),t("el-button",{on:{click:function(r){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)])},i=[],s=(t("96cf"),t("1da1")),l=t("cf45"),a=t("bc3a"),n=t.n(a);function c(e){return new Promise((function(r,t){n.a.post("".concat(l["a"].baseUrl,"/api/utils/fileUpload"),e,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){r(e)})).catch((function(e){t(e)}))}))}var u=t("61f7"),p={data:function(){var e=function(e,r,t){Object(u["a"])(r)?t():t(new Error("请输入大于0的整数"))},r=function(e,r,t){var o=/(^[1-9]\d*(\.\d{1,2})?$)|(^0(\.\d{1,2})?$)/;o.test(r)?t():t(new Error("最多两位小数"))};return{listImgs:[],imgType:1,imgTitle:"商品LOGO",imgTypeTxt:"请上传商品LOGO",goodsTypes:[],files:[],dialogImageUrl:"",ruleForm:{goods_name:"",goods_img:"",typeid:"",price:"",active_price:0,src_price:"",total_count:0,current_count:0,stock:"",made_place:"",supplier:"",recommend:1,goods_order:1,unit:"",goods_desc:""},rules:{goods_name:[{required:!0,message:"请输入商品名称",trigger:"blur"},{min:3,max:15,message:"长度在 3 到 15 个字符",trigger:"blur"}],type_name:[{required:!0,message:"请选择商品类型",trigger:"change"}],price:[{required:!0,validator:r,trigger:"blur"},{type:"string",message:"请输入商品单价"}],src_price:[{required:!0,validator:r,trigger:"blur"},{type:"string",message:"请输入商品原价"}],stock:[{required:!0,validator:e,trigger:"blur"},{type:"string",message:"请输入库存"}],made_place:[{required:!0,message:"请输入商品产地",trigger:"blur"}],supplier:[{required:!0,message:"请输入商品供应商",trigger:"blur"}],goods_order:[{required:!0,validator:e,trigger:"blur"},{type:"number",message:"请输入商品权重"}],unit:[{required:!0,message:"请输入商品规格",trigger:"change"}],goods_desc:[{required:!0,message:"请填写商品描述",trigger:"blur"}]}}},created:function(){this.getGoodsCatogory()},methods:{getGoodsCatogory:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var r,t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r={},this.$http.post("".concat(l["a"].baseUrl,"/manage/goods/getGoodsType"),r).then((function(e){t.goodsTypes=e.data.data.goodsType})).catch((function(e){}));case 2:case"end":return e.stop()}}),e,this)})));function r(){return e.apply(this,arguments)}return r}(),submitForm:function(e){var r=this;this.$refs[e].validate((function(e){if(!e)return!1;if(!r.ruleForm.goods_img)return r.$message.error("请上商品logo");var t=r.ruleForm,o=t.goods_name,i=t.goods_img,s=t.typeid,a=t.price,n=t.active_price,c=t.src_price,u=t.total_count,p=t.current_count,m=t.stock,d=t.made_place,g=t.supplier,_=t.recommend,f=t.goods_order,h=t.unit,v=t.goods_desc;a*=100,n*=100,c*=100;var b={goods_name:o,goods_img:i,typeid:s,price:a,active_price:n,src_price:c,total_count:u,current_count:p,stock:m,made_place:d,supplier:g,recommend:_,goods_order:f,unit:h,goods_desc:v},y={goodsFiles:r.listImgs,goodsInfo:b};r.$http.post("".concat(l["a"].baseUrl,"/manage/goods/createGoods"),y).then((function(e){console.log(e),e=e.data,"0000"===e.code?(r.$message.success(e.msg),r.$router.push({path:"/goods/searchGoods"})):r.$message.error(e.msg)})).catch((function(e){}))}))},resetForm:function(e){this.$refs[e].resetFields()},handlePost:function(e){var r=this,t=new FormData,o=e.file;t.append("file",o);var i=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});c(t).then((function(e){e=e.data,"0000"===e.code&&(r.listImgs.push({fileid:e.data.fileid,file_url:e.data.fileUrl,goods_file_type:r.imgType,imgTitle:r.imgTitle,previewUrl:e.data.previewUrl,uid:o.uid}),1==r.imgType&&(r.ruleForm.goods_img=e.data.fileUrl),r.$message.success(e.msg),i.close())}))},toggleUploadImg:function(e){switch(e){case 1:this.imgTypeTxt="请上传商品LOGO",this.imgTitle="LOGO",this.imgType=e;break;case 2:this.imgTypeTxt="请上传商品banner图",this.imgTitle="banner图",this.imgType=e;break;case 3:this.imgTypeTxt="请上传商品详情图",this.imgTitle="详情图",this.imgType=e;break}},extendLength:function(){},changeImage:function(e,r){this.files=r},handlePreview:function(e){this.dialogImageUrl=e.url},handleRemove:function(e,r){this.listImgs=this.listImgs.filter((function(r){return r.uid!=e.uid}))},beforeUpload:function(e){this.files.length>5&&this.$message.error("最多5张");var r=e.size/1024<500;return r||this.$message.error("图片不超过500K"),r&&this.files.length<=5}}},m=p,d=(t("755f"),t("2877")),g=Object(d["a"])(m,o,i,!1,null,"09afc1e0",null);r["default"]=g.exports}}]);